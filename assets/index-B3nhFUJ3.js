import{v4 as p}from"https://jspm.dev/uuid";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();const d=[{id:"7cec7373-681b-49d9-b065-021d61a69d03",name:"Read the sprint's theory",completed:!0,date:new Date},{id:"a7bfd5ef-37cc-4fa6-89f2-cac098a8aeba",name:"Read project instructions",completed:!1,date:new Date},{id:"aa486839-63ab-437f-b8a2-29ab217dff4f",name:"Complete project",completed:!1,date:new Date}],_={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",errorClass:"popup__error_visible",inputErrorClass:"popup__input_type_error",inactiveButtonClass:"button_disabled"};class m{constructor(t,e,r,o,i){this._data=t,this._templateElement=document.querySelector(e),this._handleCheck=r,this._handleDelete=o,this._handleTotal=i}_setEventListeners(){this._todoDeleteBtn.addEventListener("click",()=>{this._todoElement.remove(),this._handleDelete(this._data.completed)}),this._todoCheckboxEl.addEventListener("change",()=>{this._data.completed=!this._data.completed,this._handleCheck(this._data.completed)})}_generateCheckboxEl(){this._todoCheckboxEl=this._todoElement.querySelector(".todo__completed"),this._todoLabel=this._todoElement.querySelector(".todo__label"),this._todoCheckboxEl.checked=this._data.completed,this._todoCheckboxEl.id=`todo-${this._data.id}`,this._todoLabel.setAttribute("for",`todo-${this._data.id}`)}_generateDueDate(){this._dueDate=new Date(this._data.date),isNaN(this._dueDate)||(this._todoDate.textContent=`Due: ${this._dueDate.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}`)}getView(){this._todoElement=this._templateElement.content.querySelector(".todo").cloneNode(!0),this._todoDeleteBtn=this._todoElement.querySelector(".todo__delete-btn"),this._todoDate=this._todoElement.querySelector(".todo__date");const t=this._todoElement.querySelector(".todo__name");return t.textContent=this._data.name,this._generateCheckboxEl(),this._setEventListeners(),this._generateDueDate(),this._todoElement}}class f{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._errorClass=t.errorClass,this._inputErrorClass=t.inputErrorClass,this._inactiveButtonClass=t.inactiveButtonClass,this._formEl=e}_showInputError(t,e,r){const o=`#${e.id}-error`,i=t.querySelector(o);e.classList.add(this._inputErrorClass),i.textContent=r,i.classList.add(this._errorClass)}_hideInputError(t,e){const r=`#${e.id}-error`,o=t.querySelector(r);e.classList.remove(this._inputErrorClass),o.classList.remove(this._errorClass),o.textContent=""}_checkInputValidity(t){t.validity.valid?this._hideInputError(this._formEl,t):this._showInputError(this._formEl,t,t.validationMessage)}_hasInvalidInput(t){return t.some(e=>!e.validity.valid)}_toggleButtonState(t,e){this._hasInvalidInput(t)?(e.classList.add(this._inactiveButtonClass),e.disabled=!0):(e.classList.remove(this._inactiveButtonClass),e.disabled=!1)}_setEventListeners(){this._inputList=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._buttonElement=this._formEl.querySelector(this._submitButtonSelector),this._toggleButtonState(this._inputList,this._buttonElement),this._inputList.forEach(t=>{t.addEventListener("input",()=>{this._checkInputValidity(t),this._toggleButtonState(this._inputList,this._buttonElement)})})}resetValidation(){this._formEl.addEventListener("submit",t=>{this._formEl.reset(),this._toggleButtonState(this._inputList,this._buttonElement)})}enableValidation(){this._formEl.addEventListener("submit",t=>{t.preventDefault()}),this._setEventListeners(),this.resetValidation()}}class E{constructor({items:t,renderer:e,containerSelector:r}){this._items=t,this._renderer=e,this._container=document.querySelector(r)}renderItems(){this._items.forEach(t=>{this._renderer(t)})}addItem(t){this._container.append(t)}}class v{constructor({popupSelector:t}){this._popupElement=document.querySelector(t),this._popupCloseBtn=this._popupElement.querySelector(".popup__close")}open(){this._popupElement.classList.add("popup_visible"),document.addEventListener("keyup",this._handleEscapeClose)}close(){this._popupElement.classList.remove("popup_visible"),document.removeEventListener("keyup",this._handleEscapeClose)}_handleEscapeClose=t=>{t.key==="Escape"&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",t=>{(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&this.close()})}}class b extends v{constructor({popupSelector:t,handleFormSubmit:e,handleTotal:r}){super({popupSelector:t}),this._handleFormSubmit=e,this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input"),this._handleTotal=r}_getInputValues(){const t={};return this._inputList.forEach(e=>{t[e.name]=e.value}),t}getForm(){return this._popupForm}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",t=>{t.preventDefault();const e=this._getInputValues();this._handleFormSubmit(e)})}}class L{constructor(t,e){this._element=document.querySelector(e),this._completed=t.filter(r=>r.completed).length,this._total=t.length,this._updateText()}updateCompleted=t=>{this._completed+=t?1:-1,this._updateText()};updateTotal=t=>{this._total+=t?1:-1,this._updateText()};_updateText(){this._element.textContent=`Showing ${this._completed} out of ${this._total} completed`}}const S=document.querySelector(".button_action_add"),y=document.forms["add-todo-form"];document.querySelector(".todos__list");const n=new L(d,".counter__text"),l=new b({popupSelector:"#add-todo-popup",handleFormSubmit:s=>{s.id=p(),u(s),c(!0),l.close()}});function C(s){n.updateCompleted(s)}function g(s){s&&n.updateCompleted(!1),n.updateTotal(!1)}function c(s){s&&n.updateTotal(!0)}const D=s=>new m(s,"#todo-template",C,g,c).getView(),u=s=>{const t=D(s);h.addItem(t)},h=new E({items:d,renderer:s=>{u(s)},containerSelector:".todos__list"});h.renderItems();const q=new f(_,y);S.addEventListener("click",()=>{l.open()});l.setEventListeners();q.enableValidation();
